<Page x:Class="Fabrino.Views.DashBoard.InventoryPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:lvc="clr-namespace:LiveCharts.Wpf;assembly=LiveCharts.Wpf"
      Title="InventoryPage" Background="#F9FAFB">

    <Page.Resources>
        <!-- استایل Watermark برای TextBox بدون نیاز به Converter -->
        <Style x:Key="WatermarkTextBoxStyle" TargetType="TextBox">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TextBox">
                        <Grid>
                            <Border Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            CornerRadius="4"/>
                            <ScrollViewer x:Name="PART_ContentHost" Margin="5"/>
                            <TextBlock x:Name="watermarkText" 
                               Text="{TemplateBinding Tag}"
                               Foreground="LightGray"
                               Margin="8,0,0,0"
                               VerticalAlignment="Center"
                               Visibility="Collapsed"/>
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="Text" Value="">
                                <Setter TargetName="watermarkText" Property="Visibility" Value="Visible"/>
                            </Trigger>
                            <Trigger Property="Text" Value="{x:Null}">
                                <Setter TargetName="watermarkText" Property="Visibility" Value="Visible"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Page.Resources>

    <DockPanel Margin="30" LastChildFill="True">

        <!-- نوار عنوان بالا -->
        <StackPanel DockPanel.Dock="Top" Orientation="Horizontal" Margin="0,0,0,20" HorizontalAlignment="Right">
            <TextBlock Text="📦 موجودی انبار" FontSize="26" FontWeight="Bold" VerticalAlignment="Center"/>
        </StackPanel>

        <!-- کارت‌های خلاصه -->
        <WrapPanel DockPanel.Dock="Top" Margin="0,0,0,20" HorizontalAlignment="Right">
            <Border Background="White" CornerRadius="12" Width="200" Height="100" Margin="10" Padding="10" >
                <StackPanel>
                    <TextBlock Text="کل کالاها" FontWeight="Bold" FontSize="14"/>
                    <TextBlock Text="{Binding TotalItems}" FontSize="24" FontWeight="Bold"/>
                </StackPanel>
            </Border>
            <Border Background="White" CornerRadius="12" Width="200" Height="100" Margin="10" Padding="10">
                <StackPanel>
                    <TextBlock Text="کمترین موجودی" FontWeight="Bold" FontSize="14"/>
                    <TextBlock Text="{Binding MinStockItem}" FontSize="16"/>
                </StackPanel>
            </Border>
            <Border Background="White" CornerRadius="12" Width="200" Height="100" Margin="10" Padding="10" >
                <StackPanel>
                    <TextBlock Text="بیشترین موجودی" FontWeight="Bold" FontSize="14"/>
                    <TextBlock Text="{Binding MaxStockItem}" FontSize="16"/>
                </StackPanel>
            </Border>
        </WrapPanel>

        <!-- محتوای اصلی -->
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="3*"/>
                <ColumnDefinition Width="2*"/>
            </Grid.ColumnDefinitions>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <!-- فیلتر و جستجو -->
            <StackPanel Orientation="Horizontal" Margin="0,0,0,10" Grid.Column="0">
                <TextBox x:Name="SearchBox" Width="200" Height="30" Margin="5" 
                         Style="{StaticResource WatermarkTextBoxStyle}" Tag="جستجوی کالا..."/>

                <ComboBox x:Name="CategoryFilter" Width="150" Height="30" Margin="5">
                    <ComboBoxItem Content="همه دسته‌ها"/>
                    <ComboBoxItem Content="پارچه"/>
                    <ComboBoxItem Content="نخ"/>
                </ComboBox>

                <Button Content="اعمال فیلتر" Width="100" Height="30" Margin="5"/>
            </StackPanel>

            <!-- جدول کالاها -->
            <DataGrid x:Name="InventoryGrid" Grid.Row="1" Grid.Column="0" Margin="0,0,10,0"
                      AutoGenerateColumns="False" CanUserAddRows="False" IsReadOnly="True">
                <DataGrid.Columns>
                    <DataGridTextColumn Header="نام کالا" Binding="{Binding Name}" />
                    <DataGridTextColumn Header="دسته‌بندی" Binding="{Binding Category}" />
                    <DataGridTextColumn Header="تعداد موجودی" Binding="{Binding Quantity}" />
                    <DataGridTextColumn Header="قیمت واحد" Binding="{Binding UnitPrice}" />
                </DataGrid.Columns>
            </DataGrid>

            <!-- فرم افزودن کالا -->
            <Border Background="White" CornerRadius="10" Padding="15" Grid.Column="1" Margin="10">
                <StackPanel>
                    <TextBlock Text="➕ افزودن کالا" FontSize="18" FontWeight="Bold" Margin="0,0,0,10"/>

                    <TextBox x:Name="ItemNameBox" Height="30" Margin="0,0,0,10"
                             Style="{StaticResource WatermarkTextBoxStyle}" Tag="نام کالا"/>

                    <ComboBox x:Name="ItemCategoryBox" Height="30" Margin="0,0,0,10">
                        <ComboBoxItem Content="پارچه"/>
                        <ComboBoxItem Content="نخ"/>
                    </ComboBox>

                    <TextBox x:Name="ItemQuantityBox" Height="30" Margin="0,0,0,10"
                             Style="{StaticResource WatermarkTextBoxStyle}" Tag="تعداد"/>

                    <TextBox x:Name="ItemPriceBox" Height="30" Margin="0,0,0,10"
                             Style="{StaticResource WatermarkTextBoxStyle}" Tag="قیمت واحد"/>

                    <Button Content="افزودن" Height="35" Background="#59A5F7" Foreground="White" FontWeight="Bold"
                            Click="AddItem_Click"/>
                </StackPanel>
            </Border>
        </Grid>
    </DockPanel>
</Page>