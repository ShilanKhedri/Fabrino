<Page x:Class="Fabrino.Views.DashBoard.ReportPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
      xmlns:lvc="clr-namespace:LiveCharts.Wpf;assembly=LiveCharts.Wpf"
      mc:Ignorable="d"
      Title="ReportPage">

    <Grid Margin="20">
        <TabControl>
            <!-- فروش -->
            <TabItem Header="فروش">
                <StackPanel Margin="10">
                    <StackPanel Orientation="Horizontal">
                        <DatePicker x:Name="FromDatePicker" Width="130" Margin="5"/>
                        <TextBlock Text="تا" Margin="5" VerticalAlignment="Center"/>
                        <DatePicker x:Name="ToDatePicker" Width="130" Margin="5"/>
                        <Button Content="فیلتر" Click="FilterSales_Click" Margin="5"/>
                        <ComboBox x:Name="SalesExportFormat" Width="100" Margin="5">
                            <ComboBoxItem Content="PDF" IsSelected="True"/>
                            <ComboBoxItem Content="Excel"/>
                        </ComboBox>
                        <Button Content="خروجی" Click="ExportSales_Click" Margin="5"/>
                    </StackPanel>
                    <DataGrid x:Name="SalesGrid" AutoGenerateColumns="False" IsReadOnly="True" Margin="0,10">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="تاریخ" Binding="{Binding PersianOrderDate}"/>
                            <DataGridTextColumn Header="مشتری" Binding="{Binding Customer.FullName}"/>
                            <DataGridTextColumn Header="مبلغ کل" Binding="{Binding TotalAmount}"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </StackPanel>
            </TabItem>

            <!-- خرید -->
            <TabItem Header="خرید">
                <StackPanel Margin="10">
                    <DataGrid x:Name="PurchaseGrid" AutoGenerateColumns="False" IsReadOnly="True">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="تاریخ" Binding="{Binding PersianOrderDate}"/>
                            <DataGridTextColumn Header="تأمین‌کننده" Binding="{Binding Supplier.Name}"/>
                            <DataGridTextColumn Header="مبلغ کل" Binding="{Binding TotalAmount}"/>
                            <DataGridTextColumn Header="وضعیت" Binding="{Binding Status}"/>
                        </DataGrid.Columns>
                    </DataGrid>
                    <StackPanel Orientation="Horizontal" Margin="0,10">
                        <ComboBox x:Name="PurchaseExportFormat" Width="100" Margin="5">
                            <ComboBoxItem Content="PDF" IsSelected="True"/>
                            <ComboBoxItem Content="Excel"/>
                        </ComboBox>
                        <Button Content="خروجی" Click="ExportPurchase_Click" Margin="5"/>
                    </StackPanel>
                </StackPanel>
            </TabItem>

            <!-- پارچه‌ها -->
            <TabItem Header="پارچه‌ها">
                <StackPanel Margin="10">
                    <DataGrid x:Name="FabricsGrid" AutoGenerateColumns="False" IsReadOnly="True">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="نام" Binding="{Binding Name}"/>
                            <DataGridTextColumn Header="رنگ" Binding="{Binding Color}"/>
                            <DataGridTextColumn Header="جنس" Binding="{Binding Material}"/>
                            <DataGridTextColumn Header="عرض" Binding="{Binding Width}"/>
                            <DataGridTextColumn Header="موجودی" Binding="{Binding Quantity}"/>
                            <DataGridTextColumn Header="قیمت هر متر" Binding="{Binding PricePerMeter}"/>
                        </DataGrid.Columns>
                    </DataGrid>
                    <StackPanel Orientation="Horizontal" Margin="0,10">
                        <ComboBox x:Name="FabricExportFormat" Width="100" Margin="5">
                            <ComboBoxItem Content="PDF" IsSelected="True"/>
                            <ComboBoxItem Content="Excel"/>
                        </ComboBox>
                        <Button Content="خروجی" Click="ExportFabrics_Click" Margin="5"/>
                    </StackPanel>
                </StackPanel>
            </TabItem>

            <!-- کاربران -->
            <TabItem Header="کاربران">
                <StackPanel Margin="10">
                    <DataGrid x:Name="UsersGrid" AutoGenerateColumns="False" IsReadOnly="True">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="نام کامل" Binding="{Binding full_name}"/>
                            <DataGridTextColumn Header="نام کاربری" Binding="{Binding username}"/>
                            <DataGridTextColumn Header="نقش" Binding="{Binding role}"/>
                            <DataGridTextColumn Header="آخرین ورود" Binding="{Binding PersianLoginDate}"/>
                        </DataGrid.Columns>
                    </DataGrid>
                    <StackPanel Orientation="Horizontal" Margin="0,10">
                        <ComboBox x:Name="UserExportFormat" Width="100" Margin="5">
                            <ComboBoxItem Content="PDF" IsSelected="True"/>
                            <ComboBoxItem Content="Excel"/>
                        </ComboBox>
                        <Button Content="خروجی" Click="ExportUsers_Click" Margin="5"/>
                    </StackPanel>
                </StackPanel>
            </TabItem>

            <!-- نمودارها -->
            <TabItem Header="نمودارها">
                <Grid Margin="10">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>

                    <!-- نمودار فروش پارچه -->
                    <GroupBox Header="فروش بر اساس نوع پارچه" Grid.Column="0" Margin="5">
                        <lvc:CartesianChart Series="{Binding SalesChartSeries}" LegendLocation="Right">
                            <lvc:CartesianChart.AxisX>
                                <lvc:Axis Title="پارچه" Labels="{Binding FabricLabels}" />
                            </lvc:CartesianChart.AxisX>
                        </lvc:CartesianChart>
                    </GroupBox>

                    <!-- نمودار خرید -->
                    <GroupBox Header="سهم خرید تأمین‌کنندگان" Grid.Column="1" Margin="5">
                        <lvc:PieChart Series="{Binding PurchaseChartSeries}" LegendLocation="Bottom"/>
                    </GroupBox>

                    <!-- فروش ماهانه -->
                    <GroupBox Header="فروش ماهانه سال جاری" Grid.Column="2" Margin="5">
                        <lvc:CartesianChart Series="{Binding MonthlySalesChart}">
                            <lvc:CartesianChart.AxisX>
                                <lvc:Axis Title="ماه" Labels="{Binding MonthLabels}" />
                            </lvc:CartesianChart.AxisX>
                            <lvc:CartesianChart.AxisY>
                                <lvc:Axis Title="مجموع فروش (تومان)" />
                            </lvc:CartesianChart.AxisY>
                        </lvc:CartesianChart>
                    </GroupBox>
                </Grid>
            </TabItem>

        </TabControl>
    </Grid>
</Page>
